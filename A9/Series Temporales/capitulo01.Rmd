---
author: "Laura Rodríguez Navas"
date: "`r format(Sys.time(), '%B, %Y')`"
documentclass: book
principal: yes
forprint: false
fontsize: 11pt
geometry: margin = 2.5cm
bibliography: bib/library.bib
metodobib: yes
biblio-style: plainnat
csl: methods-in-ecology-and-evolution.csl
link-citations: yes
output:
  html_document: 
    toc: yes
    fig_caption: yes
  pdf_document:
    keep_tex: no
    number_sections: yes
    citation_package: natbib
    fig_caption: yes
    template: latex/template.tex
---


```{r include=FALSE}
knitr::opts_chunk$set(fig.path = 'figurasR/',
                      echo = TRUE, warning = FALSE, message = FALSE,
                      fig.pos = "H",fig.align = "center", out.width = "95%",
                      cache=FALSE)
```

<!-- \setcounter{chapter}{2} -->
<!-- \setcounter{chapter}{2} escribir 2 para capítulo 3  -->
<!-- \pagenumbering{arabic} -->

\ifdefined\ifprincipal
\else
\setlength{\parindent}{1em}
\pagestyle{fancy}
\setcounter{tocdepth}{4}
\tableofcontents
<!-- \nocite{*} -->
\fi

\ifdefined\ifdoblecara
\fancyhead{}{}
\fancyhead[LE,RO]{\scriptsize\rightmark}
\fancyfoot[LO,RE]{\scriptsize\slshape \leftmark}
\fancyfoot[C]{}
\fancyfoot[LE,RO]{\footnotesize\thepage}
\else
\fancyhead{}{}
\fancyhead[RO]{\scriptsize\rightmark}
\fancyfoot[LO]{\scriptsize\slshape \leftmark}
\fancyfoot[C]{}
\fancyfoot[RO]{\footnotesize\thepage}
\fi
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}


# Análisis de la serie temporal

Una empresa tecnológica cuya área de negocio es la inteligencia artificial es contratada por una empresa eléctrica para que diseñe un sistema de recomendación que haga ofertas personalizadas a sus clientes sobre los paquetes energéticos más adecuados a sus consumos. Para ello, la empresa primero debe llevar a cabo un análisis exhaustivo de los consumos energéticos y diseñar una técnica de predicción que sea capaz de predecir dichos consumos con un horizonte temporal dado. La empresa eléctrica suministra a la empresa tecnológica para dicho cometido los consumos eléctricos desde el 01 de enero de 2015 hasta el 31 de diciembre de 2015 medidos con una frecuencia temporal de 10 minutos.

En esta primera parte trabajamos con el fichero *Demanda_2015.csv* que contiene los datos de los consumos eléctricos desde el 01 de enero de 2015 hasta el 31 de diciembre de 2015 medidos con una frecuencia temporal de 10 minutos.

```{r warning=FALSE}
# Se cargan las librerías necesarias
library(xts)
library(ggplot2)
```


# WORKING HERE NOW

## Visualización de la serie temporal

Para empezar, leeré los datos, los manipularé un poco y visualizaré la serie temporal.

```{r}
# Cargamos los datos Demanda
data <- read.csv("Demanda_2015.csv", header = FALSE, sep = ",")

# 
colnames(data) <- c("date", "time", "demand")

# 
sum(is.na(data))

#
data$date <- as.Date(data$date, format = "%d/%m/%Y")

#
str(data)
summary(data)
head(data, 10)
```

```{r}
#
data <- cbind(datetime = paste(data$date, data$time), data)
data$datetime <- as.Date(data$datetime, format = "%Y-%m-%d %H:%M")

#
data$date <- NULL
data$time <- NULL
head(data, 10)
```

```{r warning=FALSE}
ggplot(data = data[data$datetime >= "2015-01-01 00:00:00" & data$datetime <= "2015-12-31 23:50:00", ], 
       aes(x = datetime, y = demand)) +
  geom_line(color = "#00AFBB", size = 0.5) + 
  ggtitle("Consumo eléctrico, 2015") +
  xlab("Mes") +
  ylab("Consumo en MW")
```

Es importante tener en cuenta cómo aumenta el consumo de energía tanto en los meses de verano, de mayo a septiembre, como en los días de invierno, desde noviembre hasta febrero. Esto probablemente se debe a que las personas usan la electricidad para enfriar y calentar respectivamente.


```{r}
train <- data[data$datetime <= "2015-08-31 23:50:00", ]
test <- data[data$datetime >= "2015-09-01 00:00:00", ]

sum(complete.cases(data))
sum(complete.cases(train))
sum(complete.cases(test))
sum(is.na(data))
```

```{r}
ts <- ts(train$demand, frequency = 12)
head(ts, 500)
```


