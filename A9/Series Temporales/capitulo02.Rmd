---
author: "Laura Rodríguez Navas"
date: "`r format(Sys.time(), '%B, %Y')`"
documentclass: book
principal: yes
forprint: false
fontsize: 11pt
geometry: margin = 2.5cm
bibliography: bib/library.bib
metodobib: yes
biblio-style: plainnat
csl: methods-in-ecology-and-evolution.csl
link-citations: yes
output:
  html_document: 
    toc: yes
    fig_caption: yes
  pdf_document:
    keep_tex: no
    number_sections: yes
    citation_package: natbib
    fig_caption: yes
    template: latex/template.tex
---


```{r include=FALSE}
knitr::opts_chunk$set(fig.path = 'figurasR/',
                      echo = TRUE, warning = FALSE, message = FALSE,
                      fig.pos = "H",fig.align = "center", out.width = "95%",
                      cache=FALSE)
```

<!-- \setcounter{chapter}{2} -->
<!-- \setcounter{chapter}{2} escribir 2 para capítulo 3  -->
<!-- \pagenumbering{arabic} -->

\ifdefined\ifprincipal
\else
\setlength{\parindent}{1em}
\pagestyle{fancy}
\setcounter{tocdepth}{4}
\tableofcontents
<!-- \nocite{*} -->
\fi

\ifdefined\ifdoblecara
\fancyhead{}{}
\fancyhead[LE,RO]{\scriptsize\rightmark}
\fancyfoot[LO,RE]{\scriptsize\slshape \leftmark}
\fancyfoot[C]{}
\fancyfoot[LE,RO]{\footnotesize\thepage}
\else
\fancyhead{}{}
\fancyhead[RO]{\scriptsize\rightmark}
\fancyfoot[LO]{\scriptsize\slshape \leftmark}
\fancyfoot[C]{}
\fancyfoot[RO]{\footnotesize\thepage}
\fi
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}

# WORKING HERE

# Búsqueda de outliers

Se han utilizado los siguientes paquetes para la búsqueda de outliers:

```{r}
library(tidyverse)
library(tsoutliers)
```

Durante los fines de semana, la demanda disminuye considerablemente en comparación con el resto de días de la semana, además observamos la presencia de *outliers*.

```{r eval=TRUE, include=FALSE}
data$day <- format(data$datetime, format = "%A")
data$yearday <- format(data$datetime, format = "%m%d")
```


```{r}
ggplot(data, aes(day, demand)) +
  geom_boxplot() +
  ggtitle("Consumo eléctrico por día de la semana, 2015") +
  xlab("Día") +
  ylab("Demanda en MW")
```

```{r}
hist(data$demand, main="Frecuencia de la demanda")
breakPoints <- c(0, 24392, 31664, Inf)
categories <- c("Low", "Medium", "High")
data$demand.F <- cut(data$demand, breaks = breakPoints, labels = categories)
demand_low <- data[data$demand.F == "Low", ] 
demand_low2 <- demand_low[demand_low$day != "dissabte" & demand_low$day != "diumenge", ] 
dates <- as.Date(demand_low2$date, format = '%d/%m/%Y')
dates_unique <- unique(dates)
dates_unique

```
los high pasamos de explicar que date son. ya hay suficientes ejemplos.
explicar quartiles y reemplazo de outliers en R.

```{r}
plot(data$demand)
```



```{r}
summary(data$demand)
datarm <- data[data$demand.F != "Low",]
summary(datarm)
```